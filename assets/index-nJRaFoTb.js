var kr=Object.defineProperty;var Cr=(t,e,n)=>e in t?kr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var q=(t,e,n)=>Cr(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();const fn=!1;var It=Array.isArray,Sr=Array.prototype.indexOf,qt=Array.from,Pr=Object.defineProperty,He=Object.getOwnPropertyDescriptor,Tr=Object.getOwnPropertyDescriptors,Ar=Object.prototype,zr=Array.prototype,En=Object.getPrototypeOf,cn=Object.isExtensible;const Mr=()=>{};function kn(t){for(var e=0;e<t.length;e++)t[e]()}const se=2,Cn=4,Et=8,Ht=16,ye=32,Ye=64,Ut=128,te=256,vt=512,J=1024,de=2048,Re=4096,ge=8192,jt=16384,Sn=32768,kt=65536,Dr=1<<19,Pn=1<<20,Nt=1<<21,ze=Symbol("$state"),Rr=Symbol("legacy props"),Br=Symbol("");function Tn(t){return t===this.v}function Nr(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Wt(t){return!Nr(t,this.v)}function Or(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Vr(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Fr(t){throw new Error("https://svelte.dev/e/effect_orphan")}function qr(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Hr(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Ur(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function jr(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Wr(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Yr=!1;const Xr=1,Gr=2,Kr=16,Zr=1,Jr=4,Qr=8,$r=16,ei=2,Z=Symbol(),ti="http://www.w3.org/1999/xhtml",ni="@attach";function ri(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let ne=null;function dn(t){ne=t}function ke(t,e=!1,n){var r=ne={p:ne,c:null,d:!1,e:null,m:!1,s:t,x:null,l:null};qn(()=>{r.d=!0})}function Ce(t){const e=ne;if(e!==null){t!==void 0&&(e.x=t);const s=e.e;if(s!==null){var n=N,r=O;e.e=null;try{for(var i=0;i<s.length;i++){var a=s[i];Ee(a.effect),ve(a.reaction),lt(a.fn)}}finally{Ee(n),ve(r)}}ne=e.p,e.m=!0}return t||{}}function An(){return!0}function le(t){if(typeof t!="object"||t===null||ze in t)return t;const e=En(t);if(e!==Ar&&e!==zr)return t;var n=new Map,r=It(t),i=z(0),a=O,s=u=>{var o=O;ve(a);var f=u();return ve(o),f};return r&&n.set("length",z(t.length)),new Proxy(t,{defineProperty(u,o,f){(!("value"in f)||f.configurable===!1||f.enumerable===!1||f.writable===!1)&&Ur();var v=n.get(o);return v===void 0?(v=s(()=>z(f.value)),n.set(o,v)):m(v,s(()=>le(f.value))),!0},deleteProperty(u,o){var f=n.get(o);if(f===void 0)o in u&&(n.set(o,s(()=>z(Z))),zt(i));else{if(r&&typeof o=="string"){var v=n.get("length"),d=Number(o);Number.isInteger(d)&&d<v.v&&m(v,d)}m(f,Z),zt(i)}return!0},get(u,o,f){var h;if(o===ze)return t;var v=n.get(o),d=o in u;if(v===void 0&&(!d||(h=He(u,o))!=null&&h.writable)&&(v=s(()=>z(le(d?u[o]:Z))),n.set(o,v)),v!==void 0){var c=l(v);return c===Z?void 0:c}return Reflect.get(u,o,f)},getOwnPropertyDescriptor(u,o){var f=Reflect.getOwnPropertyDescriptor(u,o);if(f&&"value"in f){var v=n.get(o);v&&(f.value=l(v))}else if(f===void 0){var d=n.get(o),c=d==null?void 0:d.v;if(d!==void 0&&c!==Z)return{enumerable:!0,configurable:!0,value:c,writable:!0}}return f},has(u,o){var c;if(o===ze)return!0;var f=n.get(o),v=f!==void 0&&f.v!==Z||Reflect.has(u,o);if(f!==void 0||N!==null&&(!v||(c=He(u,o))!=null&&c.writable)){f===void 0&&(f=s(()=>z(v?le(u[o]):Z)),n.set(o,f));var d=l(f);if(d===Z)return!1}return v},set(u,o,f,v){var S;var d=n.get(o),c=o in u;if(r&&o==="length")for(var h=f;h<d.v;h+=1){var L=n.get(h+"");L!==void 0?m(L,Z):h in u&&(L=s(()=>z(Z)),n.set(h+"",L))}d===void 0?(!c||(S=He(u,o))!=null&&S.writable)&&(d=s(()=>z(void 0)),m(d,s(()=>le(f))),n.set(o,d)):(c=d.v!==Z,m(d,s(()=>le(f))));var C=Reflect.getOwnPropertyDescriptor(u,o);if(C!=null&&C.set&&C.set.call(v,f),!c){if(r&&typeof o=="string"){var p=n.get("length"),b=Number(o);Number.isInteger(b)&&b>=p.v&&m(p,b+1)}zt(i)}return!0},ownKeys(u){l(i);var o=Reflect.ownKeys(u).filter(d=>{var c=n.get(d);return c===void 0||c.v!==Z});for(var[f,v]of n)v.v!==Z&&!(f in u)&&o.push(f);return o},setPrototypeOf(){jr()}})}function zt(t,e=1){m(t,t.v+e)}function vn(t){try{if(t!==null&&typeof t=="object"&&ze in t)return t[ze]}catch{}return t}function ii(t,e){return Object.is(vn(t),vn(e))}function at(t){var e=se|de,n=O!==null&&(O.f&se)!==0?O:null;return N===null||n!==null&&(n.f&te)!==0?e|=te:N.f|=Pn,{ctx:ne,deps:null,effects:null,equals:Tn,f:e,fn:t,reactions:null,rv:0,v:null,wv:0,parent:n??N}}function je(t){const e=at(t);return Jn(e),e}function ai(t){const e=at(t);return e.equals=Wt,e}function zn(t){var e=t.effects;if(e!==null){t.effects=null;for(var n=0;n<e.length;n+=1)ae(e[n])}}function li(t){for(var e=t.parent;e!==null;){if((e.f&se)===0)return e;e=e.parent}return null}function Mn(t){var e,n=N;Ee(li(t));try{zn(t),e=tr(t)}finally{Ee(n)}return e}function Dn(t){var e=Mn(t);if(t.equals(e)||(t.v=e,t.wv=$n()),!Ke){var n=(pe||(t.f&te)!==0)&&t.deps!==null?Re:J;oe(t,n)}}const rt=new Map;function ht(t,e){var n={f:0,v:t,reactions:null,equals:Tn,rv:0,wv:0};return n}function z(t,e){const n=ht(t);return Jn(n),n}function Rn(t,e=!1){const n=ht(t);return e||(n.equals=Wt),n}function m(t,e,n=!1){O!==null&&!fe&&An()&&(O.f&(se|Ht))!==0&&!(G!=null&&G.includes(t))&&Wr();let r=n?le(e):e;return Bn(t,r)}function Bn(t,e){if(!t.equals(e)){var n=t.v;Ke?rt.set(t,e):rt.set(t,n),t.v=e,(t.f&se)!==0&&((t.f&de)!==0&&Mn(t),oe(t,(t.f&te)===0?J:Re)),t.wv=$n(),Nn(t,de),N!==null&&(N.f&J)!==0&&(N.f&(ye|Ye))===0&&(ie===null?mi([t]):ie.push(t))}return e}function Nn(t,e){var n=t.reactions;if(n!==null)for(var r=n.length,i=0;i<r;i++){var a=n[i],s=a.f;(s&de)===0&&(oe(a,e),(s&(J|te))!==0&&((s&se)!==0?Nn(a,Re):St(a)))}}function si(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let oi=!1;var hn,On,Vn,Fn;function ui(){if(hn===void 0){hn=window,On=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,n=Text.prototype;Vn=He(e,"firstChild").get,Fn=He(e,"nextSibling").get,cn(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),cn(n)&&(n.__t=void 0)}}function Yt(t=""){return document.createTextNode(t)}function Te(t){return Vn.call(t)}function Ct(t){return Fn.call(t)}function B(t,e){return Te(t)}function fi(t,e){{var n=Te(t);return n instanceof Comment&&n.data===""?Ct(n):n}}function U(t,e=1,n=!1){let r=t;for(;e--;)r=Ct(r);return r}function ci(t){t.textContent=""}function di(t){N===null&&O===null&&Fr(),O!==null&&(O.f&te)!==0&&N===null&&Vr(),Ke&&Or()}function vi(t,e){var n=e.last;n===null?e.last=e.first=t:(n.next=t,t.prev=n,e.last=t)}function Xe(t,e,n,r=!0){var i=N,a={ctx:ne,deps:null,nodes_start:null,nodes_end:null,f:t|de,first:null,fn:e,last:null,next:null,parent:i,prev:null,teardown:null,transitions:null,wv:0};if(n)try{Kt(a),a.f|=Sn}catch(o){throw ae(a),o}else e!==null&&St(a);var s=n&&a.deps===null&&a.first===null&&a.nodes_start===null&&a.teardown===null&&(a.f&(Pn|Ut))===0;if(!s&&r&&(i!==null&&vi(a,i),O!==null&&(O.f&se)!==0)){var u=O;(u.effects??(u.effects=[])).push(a)}return a}function qn(t){const e=Xe(Et,null,!1);return oe(e,J),e.teardown=t,e}function ce(t){di();var e=N!==null&&(N.f&ye)!==0&&ne!==null&&!ne.m;if(e){var n=ne;(n.e??(n.e=[])).push({fn:t,effect:N,reaction:O})}else{var r=lt(t);return r}}function hi(t){const e=Xe(Ye,t,!0);return(n={})=>new Promise(r=>{n.outro?gt(e,()=>{ae(e),r(void 0)}):(ae(e),r(void 0))})}function lt(t){return Xe(Cn,t,!1)}function Hn(t){return Xe(Et,t,!0)}function _e(t,e=[],n=at){const r=e.map(n);return Ge(()=>t(...r.map(l)))}function Ge(t,e=0){return Xe(Et|Ht|e,t,!0)}function Ie(t,e=!0){return Xe(Et|ye,t,!0,e)}function Un(t){var e=t.teardown;if(e!==null){const n=Ke,r=O;gn(!0),ve(null);try{e.call(null)}finally{gn(n),ve(r)}}}function jn(t,e=!1){var n=t.first;for(t.first=t.last=null;n!==null;){var r=n.next;(n.f&Ye)!==0?n.parent=null:ae(n,e),n=r}}function gi(t){for(var e=t.first;e!==null;){var n=e.next;(e.f&ye)===0&&ae(e),e=n}}function ae(t,e=!0){var n=!1;(e||(t.f&Dr)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(Wn(t.nodes_start,t.nodes_end),n=!0),jn(t,e&&!n),bt(t,0),oe(t,jt);var r=t.transitions;if(r!==null)for(const a of r)a.stop();Un(t);var i=t.parent;i!==null&&i.first!==null&&Yn(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=null}function Wn(t,e){for(;t!==null;){var n=t===e?null:Ct(t);t.remove(),t=n}}function Yn(t){var e=t.parent,n=t.prev,r=t.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=n))}function gt(t,e){var n=[];Xt(t,n,!0),Xn(n,()=>{ae(t),e&&e()})}function Xn(t,e){var n=t.length;if(n>0){var r=()=>--n||e();for(var i of t)i.out(r)}else e()}function Xt(t,e,n){if((t.f&ge)===0){if(t.f^=ge,t.transitions!==null)for(const s of t.transitions)(s.is_global||n)&&e.push(s);for(var r=t.first;r!==null;){var i=r.next,a=(r.f&kt)!==0||(r.f&ye)!==0;Xt(r,e,a?n:!1),r=i}}}function _t(t){Gn(t,!0)}function Gn(t,e){if((t.f&ge)!==0){t.f^=ge,(t.f&J)===0&&(t.f^=J),st(t)&&(oe(t,de),St(t));for(var n=t.first;n!==null;){var r=n.next,i=(n.f&kt)!==0||(n.f&ye)!==0;Gn(n,i?e:!1),n=r}if(t.transitions!==null)for(const a of t.transitions)(a.is_global||e)&&a.in()}}let it=[],Ot=[];function Kn(){var t=it;it=[],kn(t)}function _i(){var t=Ot;Ot=[],kn(t)}function Gt(t){it.length===0&&queueMicrotask(Kn),it.push(t)}function yi(){it.length>0&&Kn(),Ot.length>0&&_i()}function wi(t){var e=N;if((e.f&Sn)===0){if((e.f&Ut)===0)throw t;e.fn(t)}else Zn(t,e)}function Zn(t,e){for(;e!==null;){if((e.f&Ut)!==0)try{e.fn(t);return}catch{}e=e.parent}throw t}let yt=!1,wt=null,Me=!1,Ke=!1;function gn(t){Ke=t}let nt=[];let O=null,fe=!1;function ve(t){O=t}let N=null;function Ee(t){N=t}let G=null;function Jn(t){O!==null&&O.f&Nt&&(G===null?G=[t]:G.push(t))}let Y=null,ee=0,ie=null;function mi(t){ie=t}let Qn=1,mt=0,pe=!1;function $n(){return++Qn}function st(t){var d;var e=t.f;if((e&de)!==0)return!0;if((e&Re)!==0){var n=t.deps,r=(e&te)!==0;if(n!==null){var i,a,s=(e&vt)!==0,u=r&&N!==null&&!pe,o=n.length;if(s||u){var f=t,v=f.parent;for(i=0;i<o;i++)a=n[i],(s||!((d=a==null?void 0:a.reactions)!=null&&d.includes(f)))&&(a.reactions??(a.reactions=[])).push(f);s&&(f.f^=vt),u&&v!==null&&(v.f&te)===0&&(f.f^=te)}for(i=0;i<o;i++)if(a=n[i],st(a)&&Dn(a),a.wv>t.wv)return!0}(!r||N!==null&&!pe)&&oe(t,J)}return!1}function er(t,e,n=!0){var r=t.reactions;if(r!==null)for(var i=0;i<r.length;i++){var a=r[i];G!=null&&G.includes(t)||((a.f&se)!==0?er(a,e,!1):e===a&&(n?oe(a,de):(a.f&J)!==0&&oe(a,Re),St(a)))}}function tr(t){var h;var e=Y,n=ee,r=ie,i=O,a=pe,s=G,u=ne,o=fe,f=t.f;Y=null,ee=0,ie=null,pe=(f&te)!==0&&(fe||!Me||O===null),O=(f&(ye|Ye))===0?t:null,G=null,dn(t.ctx),fe=!1,mt++,t.f|=Nt;try{var v=(0,t.fn)(),d=t.deps;if(Y!==null){var c;if(bt(t,ee),d!==null&&ee>0)for(d.length=ee+Y.length,c=0;c<Y.length;c++)d[ee+c]=Y[c];else t.deps=d=Y;if(!pe)for(c=ee;c<d.length;c++)((h=d[c]).reactions??(h.reactions=[])).push(t)}else d!==null&&ee<d.length&&(bt(t,ee),d.length=ee);if(An()&&ie!==null&&!fe&&d!==null&&(t.f&(se|Re|de))===0)for(c=0;c<ie.length;c++)er(ie[c],t);return i!==null&&i!==t&&(mt++,ie!==null&&(r===null?r=ie:r.push(...ie))),v}catch(L){wi(L)}finally{Y=e,ee=n,ie=r,O=i,pe=a,G=s,dn(u),fe=o,t.f^=Nt}}function bi(t,e){let n=e.reactions;if(n!==null){var r=Sr.call(n,t);if(r!==-1){var i=n.length-1;i===0?n=e.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(e.f&se)!==0&&(Y===null||!Y.includes(e))&&(oe(e,Re),(e.f&(te|vt))===0&&(e.f^=vt),zn(e),bt(e,0))}function bt(t,e){var n=t.deps;if(n!==null)for(var r=e;r<n.length;r++)bi(t,n[r])}function Kt(t){var e=t.f;if((e&jt)===0){oe(t,J);var n=N,r=Me;N=t,Me=!0;try{(e&Ht)!==0?gi(t):jn(t),Un(t);var i=tr(t);t.teardown=typeof i=="function"?i:null,t.wv=Qn;var a=t.deps,s;fn&&Yr&&t.f&de}finally{Me=r,N=n}}}function Li(){try{qr()}catch(t){if(wt!==null)Zn(t,wt);else throw t}}function nr(){var t=Me;try{var e=0;for(Me=!0;nt.length>0;){e++>1e3&&Li();var n=nt,r=n.length;nt=[];for(var i=0;i<r;i++){var a=pi(n[i]);xi(a)}rt.clear()}}finally{yt=!1,Me=t,wt=null}}function xi(t){var e=t.length;if(e!==0)for(var n=0;n<e;n++){var r=t[n];(r.f&(jt|ge))===0&&st(r)&&(Kt(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?Yn(r):r.fn=null))}}function St(t){yt||(yt=!0,queueMicrotask(nr));for(var e=wt=t;e.parent!==null;){e=e.parent;var n=e.f;if((n&(Ye|ye))!==0){if((n&J)===0)return;e.f^=J}}nt.push(e)}function pi(t){for(var e=[],n=t;n!==null;){var r=n.f,i=(r&(ye|Ye))!==0,a=i&&(r&J)!==0;if(!a&&(r&ge)===0){(r&Cn)!==0?e.push(n):i?n.f^=J:st(n)&&Kt(n);var s=n.first;if(s!==null){n=s;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)n=u.next,u=u.parent}return e}function Ii(t){for(var e;;){if(yi(),nt.length===0)return e;yt=!0,nr()}}async function rr(){await Promise.resolve(),Ii()}function l(t){var e=t.f,n=(e&se)!==0;if(O!==null&&!fe){if(!(G!=null&&G.includes(t))){var r=O.deps;t.rv<mt&&(t.rv=mt,Y===null&&r!==null&&r[ee]===t?ee++:Y===null?Y=[t]:(!pe||!Y.includes(t))&&Y.push(t))}}else if(n&&t.deps===null&&t.effects===null){var i=t,a=i.parent;a!==null&&(a.f&te)===0&&(i.f^=te)}return n&&(i=t,st(i)&&Dn(i)),Ke&&rt.has(t)?rt.get(t):t.v}function We(t){var e=fe;try{return fe=!0,t()}finally{fe=e}}const Ei=-7169;function oe(t,e){t.f=t.f&Ei|e}function ki(t){return t.endsWith("capture")&&t!=="gotpointercapture"&&t!=="lostpointercapture"}const Ci=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function Si(t){return Ci.includes(t)}const Pi={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function Ti(t){return t=t.toLowerCase(),Pi[t]??t}const Ai=["touchstart","touchmove"];function zi(t){return Ai.includes(t)}function Mi(t,e){if(e){const n=document.body;t.autofocus=!0,Gt(()=>{document.activeElement===n&&t.focus()})}}let _n=!1;function Di(){_n||(_n=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const n of t.target.elements)(e=n.__on_r)==null||e.call(n)})},{capture:!0}))}function ir(t){var e=O,n=N;ve(null),Ee(null);try{return t()}finally{ve(e),Ee(n)}}function Ri(t,e,n,r=n){t.addEventListener(e,()=>ir(n));const i=t.__on_r;i?t.__on_r=()=>{i(),r(!0)}:t.__on_r=()=>r(!0),Di()}const ar=new Set,Vt=new Set;function lr(t,e,n,r={}){function i(a){if(r.capture||tt.call(e,a),!a.cancelBubble)return ir(()=>n==null?void 0:n.call(this,a))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Gt(()=>{e.addEventListener(t,i,r)}):e.addEventListener(t,i,r),i}function Pe(t,e,n,r,i){var a={capture:r,passive:i},s=lr(t,e,n,a);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&qn(()=>{e.removeEventListener(t,s,a)})}function Be(t){for(var e=0;e<t.length;e++)ar.add(t[e]);for(var n of Vt)n(t)}function tt(t){var S;var e=this,n=e.ownerDocument,r=t.type,i=((S=t.composedPath)==null?void 0:S.call(t))||[],a=i[0]||t.target,s=0,u=t.__root;if(u){var o=i.indexOf(u);if(o!==-1&&(e===document||e===window)){t.__root=e;return}var f=i.indexOf(e);if(f===-1)return;o<=f&&(s=o)}if(a=i[s]||t.target,a!==e){Pr(t,"currentTarget",{configurable:!0,get(){return a||n}});var v=O,d=N;ve(null),Ee(null);try{for(var c,h=[];a!==null;){var L=a.assignedSlot||a.parentNode||a.host||null;try{var C=a["__"+r];if(C!=null&&(!a.disabled||t.target===a))if(It(C)){var[p,...b]=C;p.apply(a,[t,...b])}else C.call(a,t)}catch(x){c?h.push(x):c=x}if(t.cancelBubble||L===e||L===null)break;a=L}if(c){for(let x of h)queueMicrotask(()=>{throw x});throw c}}finally{t.__root=e,delete t.currentTarget,ve(v),Ee(d)}}}function sr(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function Zt(t,e){var n=N;n.nodes_start===null&&(n.nodes_start=t,n.nodes_end=e)}function Q(t,e){var n=(e&ei)!==0,r,i=!t.startsWith("<!>");return()=>{r===void 0&&(r=sr(i?t:"<!>"+t),r=Te(r));var a=n||On?document.importNode(r,!0):r.cloneNode(!0);return Zt(a,a),a}}function Bi(){var t=document.createDocumentFragment(),e=document.createComment(""),n=Yt();return t.append(e,n),Zt(e,n),t}function X(t,e){t!==null&&t.before(e)}function Pt(t,e){var n=e==null?"":typeof e=="object"?e+"":e;n!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=n,t.nodeValue=n+"")}function Ni(t,e){return Oi(t,e)}const Fe=new Map;function Oi(t,{target:e,anchor:n,props:r={},events:i,context:a,intro:s=!0}){ui();var u=new Set,o=d=>{for(var c=0;c<d.length;c++){var h=d[c];if(!u.has(h)){u.add(h);var L=zi(h);e.addEventListener(h,tt,{passive:L});var C=Fe.get(h);C===void 0?(document.addEventListener(h,tt,{passive:L}),Fe.set(h,1)):Fe.set(h,C+1)}}};o(qt(ar)),Vt.add(o);var f=void 0,v=hi(()=>{var d=n??e.appendChild(Yt());return Ie(()=>{if(a){ke({});var c=ne;c.c=a}i&&(r.$$events=i),f=t(d,r)||{},a&&Ce()}),()=>{var L;for(var c of u){e.removeEventListener(c,tt);var h=Fe.get(c);--h===0?(document.removeEventListener(c,tt),Fe.delete(c)):Fe.set(c,h)}Vt.delete(o),d!==n&&((L=d.parentNode)==null||L.removeChild(d))}});return Vi.set(f,v),f}let Vi=new WeakMap;function Ue(t,e,[n,r]=[0,0]){var i=t,a=null,s=null,u=Z,o=n>0?kt:0,f=!1;const v=(c,h=!0)=>{f=!0,d(h,c)},d=(c,h)=>{u!==(u=c)&&(u?(a?_t(a):h&&(a=Ie(()=>h(i))),s&&gt(s,()=>{s=null})):(s?_t(s):h&&(s=Ie(()=>h(i,[n+1,r]))),a&&gt(a,()=>{a=null})))};Ge(()=>{f=!1,e(v),f||d(null,null)},o)}function Fi(t,e,n,r){for(var i=[],a=e.length,s=0;s<a;s++)Xt(e[s].e,i,!0);var u=a>0&&i.length===0&&n!==null;if(u){var o=n.parentNode;ci(o),o.append(n),r.clear(),Le(t,e[0].prev,e[a-1].next)}Xn(i,()=>{for(var f=0;f<a;f++){var v=e[f];u||(r.delete(v.k),Le(t,v.prev,v.next)),ae(v.e,!u)}})}function qi(t,e,n,r,i,a=null){var s=t,u={flags:e,items:new Map,first:null};{var o=t;s=o.appendChild(Yt())}var f=null,v=!1,d=ai(()=>{var c=n();return It(c)?c:c==null?[]:qt(c)});Ge(()=>{var c=l(d),h=c.length;v&&h===0||(v=h===0,Hi(c,u,s,i,e,r,n),a!==null&&(h===0?f?_t(f):f=Ie(()=>a(s)):f!==null&&gt(f,()=>{f=null})),l(d))})}function Hi(t,e,n,r,i,a,s){var u=t.length,o=e.items,f=e.first,v=f,d,c=null,h=[],L=[],C,p,b,S;for(S=0;S<u;S+=1){if(C=t[S],p=a(C,S),b=o.get(p),b===void 0){var x=v?v.e.nodes_start:n;c=ji(x,e,c,c===null?e.first:c.next,C,p,S,r,i,s),o.set(p,c),h=[],L=[],v=c.next;continue}if(Ui(b,C,S),(b.e.f&ge)!==0&&_t(b.e),b!==v){if(d!==void 0&&d.has(b)){if(h.length<L.length){var w=L[0],E;c=w.prev;var g=h[0],_=h[h.length-1];for(E=0;E<h.length;E+=1)yn(h[E],w,n);for(E=0;E<L.length;E+=1)d.delete(L[E]);Le(e,g.prev,_.next),Le(e,c,g),Le(e,_,w),v=w,c=_,S-=1,h=[],L=[]}else d.delete(b),yn(b,v,n),Le(e,b.prev,b.next),Le(e,b,c===null?e.first:c.next),Le(e,c,b),c=b;continue}for(h=[],L=[];v!==null&&v.k!==p;)(v.e.f&ge)===0&&(d??(d=new Set)).add(v),L.push(v),v=v.next;if(v===null)continue;b=v}h.push(b),c=b,v=b.next}if(v!==null||d!==void 0){for(var M=d===void 0?[]:qt(d);v!==null;)(v.e.f&ge)===0&&M.push(v),v=v.next;var W=M.length;if(W>0){var $=u===0?n:null;Fi(e,M,$,o)}}N.first=e.first&&e.first.e,N.last=c&&c.e}function Ui(t,e,n,r){Bn(t.v,e),t.i=n}function ji(t,e,n,r,i,a,s,u,o,f){var v=(o&Xr)!==0,d=(o&Kr)===0,c=v?d?Rn(i):ht(i):i,h=(o&Gr)===0?s:ht(s),L={i:h,v:c,k:a,a:null,e:null,prev:n,next:r};try{return L.e=Ie(()=>u(t,c,h,f),oi),L.e.prev=n&&n.e,L.e.next=r&&r.e,n===null?e.first=L:(n.next=L,n.e.next=L.e),r!==null&&(r.prev=L,r.e.prev=L.e),L}finally{}}function yn(t,e,n){for(var r=t.next?t.next.e.nodes_start:n,i=e?e.e.nodes_start:n,a=t.e.nodes_start;a!==r;){var s=Ct(a);i.before(a),a=s}}function Le(t,e,n){e===null?t.first=n:(e.next=n,e.e.next=n&&n.e),n!==null&&(n.prev=e,n.e.prev=e&&e.e)}function Wi(t,e,n=!1,r=!1,i=!1){var a=t,s="";_e(()=>{var u=N;if(s!==(s=e()??"")&&(u.nodes_start!==null&&(Wn(u.nodes_start,u.nodes_end),u.nodes_start=u.nodes_end=null),s!=="")){var o=s+"";n?o=`<svg>${o}</svg>`:r&&(o=`<math>${o}</math>`);var f=sr(o);if((n||r)&&(f=Te(f)),Zt(Te(f),f.lastChild),n||r)for(;Te(f);)a.before(Te(f));else a.before(f)}})}function Yi(t,e,...n){var r=t,i=Mr,a;Ge(()=>{i!==(i=e())&&(a&&(ae(a),a=null),a=Ie(()=>i(r,...n)))},kt)}function Xi(t,e){var n=void 0,r;Ge(()=>{n!==(n=e())&&(r&&(ae(r),r=null),n&&(r=Ie(()=>{lt(()=>n(t))})))})}function or(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=or(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Gi(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=or(t))&&(r&&(r+=" "),r+=e);return r}function Ki(t){return typeof t=="object"?Gi(t):t??""}const wn=[...` 	
\r\f \v\uFEFF`];function Zi(t,e,n){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var a=i.length,s=0;(s=r.indexOf(i,s))>=0;){var u=s+a;(s===0||wn.includes(r[s-1]))&&(u===r.length||wn.includes(r[u]))?r=(s===0?"":r.substring(0,s))+r.substring(u+1):s=u}}return r===""?null:r}function mn(t,e=!1){var n=e?" !important;":";",r="";for(var i in t){var a=t[i];a!=null&&a!==""&&(r+=" "+i+": "+a+n)}return r}function Mt(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Ji(t,e){if(e){var n="",r,i;if(Array.isArray(e)?(r=e[0],i=e[1]):r=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var a=!1,s=0,u=!1,o=[];r&&o.push(...Object.keys(r).map(Mt)),i&&o.push(...Object.keys(i).map(Mt));var f=0,v=-1;const C=t.length;for(var d=0;d<C;d++){var c=t[d];if(u?c==="/"&&t[d-1]==="*"&&(u=!1):a?a===c&&(a=!1):c==="/"&&t[d+1]==="*"?u=!0:c==='"'||c==="'"?a=c:c==="("?s++:c===")"&&s--,!u&&a===!1&&s===0){if(c===":"&&v===-1)v=d;else if(c===";"||d===C-1){if(v!==-1){var h=Mt(t.substring(f,v).trim());if(!o.includes(h)){c!==";"&&d++;var L=t.substring(f,d).trim();n+=" "+L+";"}}f=d+1,v=-1}}}}return r&&(n+=mn(r)),i&&(n+=mn(i,!0)),n=n.trim(),n===""?null:n}return t==null?null:String(t)}function qe(t,e,n,r,i,a){var s=t.__className;if(s!==n||s===void 0){var u=Zi(n,r,a);u==null?t.removeAttribute("class"):e?t.className=u:t.setAttribute("class",u),t.__className=n}else if(a&&i!==a)for(var o in a){var f=!!a[o];(i==null||f!==!!i[o])&&t.classList.toggle(o,f)}return a}function Dt(t,e={},n,r){for(var i in n){var a=n[i];e[i]!==a&&(n[i]==null?t.style.removeProperty(i):t.style.setProperty(i,a,r))}}function Lt(t,e,n,r){var i=t.__style;if(i!==e){var a=Ji(e,r);a==null?t.removeAttribute("style"):t.style.cssText=a,t.__style=e}else r&&(Array.isArray(r)?(Dt(t,n==null?void 0:n[0],r[0]),Dt(t,n==null?void 0:n[1],r[1],"important")):Dt(t,n,r));return r}function Ft(t,e,n){if(t.multiple){if(e==null)return;if(!It(e))return si();for(var r of t.options)r.selected=e.includes(bn(r));return}for(r of t.options){var i=bn(r);if(ii(i,e)){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Qi(t,e){let n=!0;lt(()=>{e&&Ft(t,We(e),n),n=!1;var r=new MutationObserver(()=>{var i=t.__value;Ft(t,i)});return r.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function bn(t){return"__value"in t?t.__value:t.value}const ct=Symbol("class"),et=Symbol("style"),ur=Symbol("is custom element"),fr=Symbol("is html");function Jt(t,e){var n=Qt(t);n.value===(n.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function $i(t,e){e?t.hasAttribute("selected")||t.setAttribute("selected",""):t.removeAttribute("selected")}function Ae(t,e,n,r){var i=Qt(t);i[e]!==(i[e]=n)&&(e==="loading"&&(t[Br]=n),n==null?t.removeAttribute(e):typeof n!="string"&&cr(t).includes(e)?t[e]=n:t.setAttribute(e,n))}function ea(t,e,n,r,i=!1){var a=Qt(t),s=a[ur],u=!a[fr],o=e||{},f=t.tagName==="OPTION";for(var v in e)v in n||(n[v]=null);n.class?n.class=Ki(n.class):n.class=null,n[et]&&(n.style??(n.style=null));var d=cr(t);for(const x in n){let w=n[x];if(f&&x==="value"&&w==null){t.value=t.__value="",o[x]=w;continue}if(x==="class"){var c=t.namespaceURI==="http://www.w3.org/1999/xhtml";qe(t,c,w,r,e==null?void 0:e[ct],n[ct]),o[x]=w,o[ct]=n[ct];continue}if(x==="style"){Lt(t,w,e==null?void 0:e[et],n[et]),o[x]=w,o[et]=n[et];continue}var h=o[x];if(w!==h){o[x]=w;var L=x[0]+x[1];if(L!=="$$")if(L==="on"){const E={},g="$$"+x;let _=x.slice(2);var C=Si(_);if(ki(_)&&(_=_.slice(0,-7),E.capture=!0),!C&&h){if(w!=null)continue;t.removeEventListener(_,o[g],E),o[g]=null}if(w!=null)if(C)t[`__${_}`]=w,Be([_]);else{let M=function(W){o[x].call(this,W)};var S=M;o[g]=lr(_,t,M,E)}else C&&(t[`__${_}`]=void 0)}else if(x==="style")Ae(t,x,w);else if(x==="autofocus")Mi(t,!!w);else if(!s&&(x==="__value"||x==="value"&&w!=null))t.value=t.__value=w;else if(x==="selected"&&f)$i(t,w);else{var p=x;u||(p=Ti(p));var b=p==="defaultValue"||p==="defaultChecked";if(w==null&&!s&&!b)if(a[x]=null,p==="value"||p==="checked"){let E=t;const g=e===void 0;if(p==="value"){let _=E.defaultValue;E.removeAttribute(p),E.defaultValue=_,E.value=E.__value=g?_:null}else{let _=E.defaultChecked;E.removeAttribute(p),E.defaultChecked=_,E.checked=g?_:!1}}else t.removeAttribute(x);else b||d.includes(p)&&(s||typeof w!="string")?t[p]=w:typeof w!="function"&&Ae(t,p,w)}}}return o}function ta(t,e,n=[],r,i=!1,a=at){const s=n.map(a);var u=void 0,o={},f=t.nodeName==="SELECT",v=!1;Ge(()=>{var d=e(...s.map(l));ea(t,u,d,r,i),v&&f&&"value"in d&&Ft(t,d.value,!1);for(let h of Object.getOwnPropertySymbols(o))d[h]||ae(o[h]);for(let h of Object.getOwnPropertySymbols(d)){var c=d[h];h.description===ni&&(!u||c!==u[h])&&(o[h]&&ae(o[h]),o[h]=Ie(()=>Xi(t,()=>c)))}u=d}),f&&Qi(t,()=>u.value),v=!0}function Qt(t){return t.__attributes??(t.__attributes={[ur]:t.nodeName.includes("-"),[fr]:t.namespaceURI===ti})}var Ln=new Map;function cr(t){var e=Ln.get(t.nodeName);if(e)return e;Ln.set(t.nodeName,e=[]);for(var n,r=t,i=Element.prototype;i!==r;){n=Tr(r);for(var a in n)n[a].set&&e.push(a);r=En(r)}return e}function na(t,e,n=e){Ri(t,"input",r=>{var i=r?t.defaultValue:t.value;if(i=Rt(t)?Bt(i):i,n(i),i!==(i=e())){var a=t.selectionStart,s=t.selectionEnd;t.value=i??"",s!==null&&(t.selectionStart=a,t.selectionEnd=Math.min(s,t.value.length))}}),We(e)==null&&t.value&&n(Rt(t)?Bt(t.value):t.value),Hn(()=>{var r=e();Rt(t)&&r===Bt(t.value)||t.type==="date"&&!r&&!t.value||r!==t.value&&(t.value=r??"")})}function Rt(t){var e=t.type;return e==="number"||e==="range"}function Bt(t){return t===""?null:+t}function xn(t,e){return t===e||(t==null?void 0:t[ze])===e}function De(t={},e,n,r){return lt(()=>{var i,a;return Hn(()=>{i=a,a=[],We(()=>{t!==n(...a)&&(e(t,...a),i&&xn(n(...i),t)&&e(null,...i))})}),()=>{Gt(()=>{a&&xn(n(...a),t)&&e(null,...a)})}}),t}let dt=!1;function ra(t){var e=dt;try{return dt=!1,[t(),dt]}finally{dt=e}}const ia={get(t,e){if(!t.exclude.includes(e))return t.props[e]},set(t,e){return!1},getOwnPropertyDescriptor(t,e){if(!t.exclude.includes(e)&&e in t.props)return{enumerable:!0,configurable:!0,value:t.props[e]}},has(t,e){return t.exclude.includes(e)?!1:e in t.props},ownKeys(t){return Reflect.ownKeys(t.props).filter(e=>!t.exclude.includes(e))}};function aa(t,e,n){return new Proxy({props:t,exclude:e},ia)}function pn(t){var e;return((e=t.ctx)==null?void 0:e.d)??!1}function F(t,e,n,r){var E;var i=(n&Zr)!==0,a=!0,s=(n&Qr)!==0,u=(n&$r)!==0,o=!1,f;s?[f,o]=ra(()=>t[e]):f=t[e];var v=ze in t||Rr in t,d=s&&(((E=He(t,e))==null?void 0:E.set)??(v&&e in t&&(g=>t[e]=g)))||void 0,c=r,h=!0,L=!1,C=()=>(L=!0,h&&(h=!1,u?c=We(r):c=r),c);f===void 0&&r!==void 0&&(d&&a&&Hr(),f=C(),d&&d(f));var p;if(p=()=>{var g=t[e];return g===void 0?C():(h=!0,L=!1,g)},(n&Jr)===0&&a)return p;if(d){var b=t.$$legacy;return function(g,_){return arguments.length>0?((!_||b||o)&&d(_?p():g),g):p()}}var S=!1,x=Rn(f),w=at(()=>{var g=p(),_=l(x);return S?(S=!1,_):x.v=g});return s&&l(w),i||(w.equals=Wt),function(g,_){if(arguments.length>0){const M=_?l(w):s?le(g):g;if(!w.equals(M)){if(S=!0,m(x,M),L&&c!==void 0&&(c=M),pn(w))return g;We(()=>l(w))}return g}return pn(w)?w.v:l(w)}}function la(t){ne===null&&ri(),ce(()=>{const e=We(t);if(typeof e=="function")return e})}const sa="5";var In;typeof window<"u"&&((In=window.__svelte??(window.__svelte={})).v??(In.v=new Set)).add(sa);function $t(t,e){const n=document.createElement("canvas");n.width=t,n.height=e;const r=n.getContext("2d");if(!r)throw new Error("Failed to get 2D context for temporary canvas");return{canvas:n,context:r}}function en(t){const{canvas:e,context:n}=$t(t.width,t.height);return n.drawImage(t,0,0),{canvas:e,context:n}}function oa(t,e,n){const{canvas:r,context:i}=$t(n.width,n.height),a=n.width/e.width,s=n.height/e.height;i.scale(a,s);for(const u of t)i.drawImage(u,0,0);return{canvas:r,context:i}}function ua(t){const{canvas:e,context:n}=en(t);return{canvas:e,context:n,width:t.width,height:t.height}}function fa(t,e,n){const{canvas:r}=en(t);t.width=n.width,t.height=n.height,e.drawImage(r,0,0)}function dr(t,e){e.clearRect(0,0,t.width,t.height)}function ca(t,e="image/png",n){return new Promise(r=>{t.toBlob(r,e,n)})}async function da(t,e,n="image/png",r){const i=await ca(t,n,r);return i?new File([i],e,{type:n}):null}class va{constructor(e,n){q(this,"layers",[]);q(this,"activeLayerId",null);q(this,"nextLayerId",0);this.addLayer("Background",e,n)}findLayerById(e){return this.layers.find(n=>n.id===e)||null}findLayerIndexById(e){return this.layers.findIndex(n=>n.id===e)}createLayer(e,n,r,i){const{canvas:a,context:s}=$t(n,r);return{id:`layer-${this.nextLayerId++}`,name:e,canvas:a,context:s,isVisible:!0,zIndex:i}}addLayer(e=`Layer ${this.layers.length+1}`,n,r){const i=this.getActiveLayer();let a,s;i?(a=this.findLayerIndexById(i.id)+1,s=i.zIndex+1,this.layers.forEach(o=>{o.zIndex>=s&&(o.zIndex+=1)})):(a=this.layers.length,s=this.layers.length>0?Math.max(...this.layers.map(o=>o.zIndex))+1:0);const u=this.createLayer(e,n,r,s);return this.layers.splice(a,0,u),this.activeLayerId=u.id,u}deleteLayer(e){var r;if(this.layers.length<=1){console.warn("Cannot delete the last layer.");return}const n=this.findLayerIndexById(e);n!==-1&&(this.layers.splice(n,1),this.activeLayerId===e&&(this.activeLayerId=((r=this.layers[this.layers.length-1])==null?void 0:r.id)||null),this.layers.sort((i,a)=>i.zIndex-a.zIndex).forEach((i,a)=>{i.zIndex=a}))}setActiveLayer(e){this.findLayerById(e)&&(this.activeLayerId=e)}getActiveLayer(){return this.activeLayerId?this.findLayerById(this.activeLayerId):null}getLayers(){return[...this.layers].sort((e,n)=>e.zIndex-n.zIndex)}toggleLayerVisibility(e){const n=this.findLayerById(e);n&&(n.isVisible=!n.isVisible)}reorderLayer(e,n){const r=this.findLayerIndexById(e);if(r===-1)return null;const i=this.layers.splice(r,1)[0];this.layers.splice(n,0,i);const a=i.zIndex;return this.layers.forEach((s,u)=>{s.zIndex=u}),{oldVisualIndex:a,newVisualIndex:i.zIndex}}resizeLayers(e,n){const r={width:e,height:n};this.layers.forEach(i=>{fa(i.canvas,i.context,r)})}addLayerWithData(e,n){if(this.findLayerById(e.id))return console.warn(`Layer with ID ${e.id} already exists. Cannot re-add.`),null;const{canvas:r,context:i}=en(e.canvas),a={...e,canvas:r,context:i};return n!==void 0&&n>=0&&n<=this.layers.length?this.layers.splice(n,0,a):this.layers.push(a),this.layers.sort((s,u)=>s.zIndex-u.zIndex),this.layers.forEach((s,u)=>{s.zIndex=u}),!this.activeLayerId&&this.layers.length>0?this.activeLayerId=this.layers[this.layers.length-1].id:this.layers.length===1&&(this.activeLayerId=this.layers[0].id),a}renameLayer(e,n){const r=this.findLayerById(e);if(r){const i=r.name;return i===n?null:(r.name=n,{oldName:i})}return null}}function vr(t){return Math.max(.1,Math.min(1,t||1))}function ha(t,e,n=.3){const r=t-e;return Math.abs(r)>n?e+(r>0?n:-n):t}function xt(t,e){return e<=1?1:1+(t-.1)/(1-.1)*(e-1)}function hr(t){return vr(t)}function gr(t,e){const n=vr(t);return ha(n,e.lastPressure)}function _r(t,e,n=.05){return Math.abs(t-e)>n}function tn(t,e){t.globalCompositeOperation=e}function ga(t){t.globalCompositeOperation="source-over"}function _a(t,e){t.beginPath(),e.color!==void 0&&(t.strokeStyle=e.color),t.lineWidth=e.lineWidth||1,t.lineCap=e.lineCap||"round",t.lineJoin=e.lineJoin||"round"}function nn(t,e,n,r){_a(t,e),t.moveTo(n,r)}function yr(t,e,n,r,i,a){t.lineTo(i,a),t.stroke(),nn(t,e,n,r)}class ya{constructor(){q(this,"drawing",!1);q(this,"lastX",0);q(this,"lastY",0);q(this,"pressureState",{lastPressure:0})}activate(e){tn(e,"source-over")}deactivate(e){}onPointerDown(e,n,r,i,a){if(e.button!==0)return;this.drawing=!0;const s=hr(a);this.pressureState.lastPressure=s,this.lastX=e.offsetX,this.lastY=e.offsetY,nn(n.context,{color:r,lineWidth:xt(s,i)},this.lastX,this.lastY)}onPointerMove(e,n,r,i,a){if(!this.drawing)return;const s=gr(a,this.pressureState);_r(s,this.pressureState.lastPressure)&&(yr(n.context,{color:r,lineWidth:xt(s,i)},this.lastX,this.lastY,e.offsetX,e.offsetY),this.pressureState.lastPressure=s),n.context.lineTo(e.offsetX,e.offsetY),n.context.stroke(),this.lastX=e.offsetX,this.lastY=e.offsetY}onPointerUp(e,n){e.button===0&&this.drawing&&(this.drawing=!1,this.pressureState.lastPressure=0)}}class wa{constructor(){q(this,"erasing",!1);q(this,"lastX",0);q(this,"lastY",0);q(this,"pressureState",{lastPressure:0})}activate(e){tn(e,"destination-out")}deactivate(e){ga(e)}onPointerDown(e,n,r,i,a){if(e.button!==0)return;this.erasing=!0;const s=hr(a);this.pressureState.lastPressure=s,this.lastX=e.offsetX,this.lastY=e.offsetY,nn(n.context,{lineWidth:xt(s,i)},this.lastX,this.lastY)}onPointerMove(e,n,r,i,a){if(!this.erasing)return;const s=gr(a,this.pressureState);_r(s,this.pressureState.lastPressure)&&(yr(n.context,{lineWidth:xt(s,i)},this.lastX,this.lastY,e.offsetX,e.offsetY),this.pressureState.lastPressure=s),n.context.lineTo(e.offsetX,e.offsetY),n.context.stroke(),this.lastX=e.offsetX,this.lastY=e.offsetY}onPointerUp(e,n){e.button===0&&this.erasing&&(this.erasing=!1,this.pressureState.lastPressure=0)}}class ma{constructor(){q(this,"filling",!1)}activate(e){tn(e,"source-over")}deactivate(e){}onPointerDown(e,n,r,i,a){e.button===0&&(this.filling=!0,this.floodFill(n,e.offsetX,e.offsetY,r))}onPointerMove(e,n,r,i,a){}onPointerUp(e,n){e.button===0&&(this.filling=!1)}floodFill(e,n,r,i){const a=e.canvas,s=e.context,u=s.getImageData(0,0,a.width,a.height),o=u.data,f=this.hexToRGBA(i),v=(Math.floor(r)*a.width+Math.floor(n))*4,d=o[v],c=o[v+1],h=o[v+2],L=o[v+3];if(d===f.r&&c===f.g&&h===f.b&&L===f.a)return;const C=[[Math.floor(n),Math.floor(r)]],p=new Set;for(;C.length>0;){const[b,S]=C.pop();if(b<0||b>=a.width||S<0||S>=a.height)continue;const x=`${b},${S}`;if(p.has(x))continue;p.add(x);const w=(S*a.width+b)*4;o[w]!==d||o[w+1]!==c||o[w+2]!==h||o[w+3]!==L||(o[w]=f.r,o[w+1]=f.g,o[w+2]=f.b,o[w+3]=f.a,C.push([b+1,S]),C.push([b-1,S]),C.push([b,S+1]),C.push([b,S-1]))}s.putImageData(u,0,0)}hexToRGBA(e){e=e.replace("#","");const n=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),i=parseInt(e.substring(4,6),16);return{r:n,g:r,b:i,a:255}}}class ba{constructor(){q(this,"undoStack",[]);q(this,"redoStack",[]);q(this,"maxHistorySize",100)}addHistory(e){this.undoStack.length>=this.maxHistorySize&&this.undoStack.shift(),this.undoStack.push(e),this.redoStack=[]}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(e){if(!this.canUndo())return;const n=this.undoStack.pop();n&&(e(n,!0),this.redoStack.push(n),console.log("Undone:",n))}redo(e){if(!this.canRedo())return;const n=this.redoStack.pop();n&&(e(n,!1),this.undoStack.push(n),console.log("Redone:",n))}clear(){this.undoStack=[],this.redoStack=[]}}function pt(t){return t.toDataURL()}class La{constructor(e){q(this,"context");q(this,"applyHistoryAction",(e,n)=>{const{layerManager:r,width:i,height:a,requestRedraw:s,updateExternalStatePartial:u}=this.context;if(!r)return;const o=e.layerId?r.findLayerById(e.layerId):null;if(!o&&e.type!=="addLayer"&&e.type!=="deleteLayer"&&e.type!=="reorderLayer"){console.warn("Layer not found for history action:",e);return}switch(e.type){case"stroke":case"clearLayer":this.handleStrokeOrClearAction(e,n,o,s),u(!0,!1,!1);break;case"addLayer":this.handleAddLayerAction(e,n,r,i,a),u(!0,!0,!1);break;case"deleteLayer":this.handleDeleteLayerAction(e,n,r),u(!0,!0,!1);break;case"toggleLayerVisibility":this.handleToggleVisibilityAction(e,n,o),u(!0,!1,!1);break;case"reorderLayer":this.handleReorderLayerAction(e,n,r),u(!0,!1,!1);break;case"renameLayer":this.handleRenameLayerAction(e,n,o),u(!0,!1,!1);break}s()});this.context=e}updateContext(e){this.context=e}handleStrokeOrClearAction(e,n,r,i){if(r){const a=n?e.imageDataBefore:e.imageDataAfter;if(a){const s=new Image;s.onload=()=>{dr(r.canvas,r.context),r.context.drawImage(s,0,0),i()},s.src=a}}}handleAddLayerAction(e,n,r,i,a){n?e.layerId&&r.deleteLayer(e.layerId):r.addLayer(void 0,i,a)}handleDeleteLayerAction(e,n,r){n?e.deletedLayerData&&r.addLayerWithData(e.deletedLayerData,e.deletedLayerIndex):e.layerId&&r.deleteLayer(e.layerId)}handleToggleVisibilityAction(e,n,r){r&&e.visibilityBefore!==void 0&&(r.isVisible=n?e.visibilityBefore:!e.visibilityBefore)}handleReorderLayerAction(e,n,r){if(e.meta&&e.meta.targetLayerId&&e.meta.oldVisualIndex!==void 0&&e.meta.newVisualIndex!==void 0){const i=e.meta.targetLayerId,a=n?e.meta.oldVisualIndex:e.meta.newVisualIndex;r.reorderLayer(i,a)}}handleRenameLayerAction(e,n,r){if(r&&e.meta&&e.meta.oldName!==void 0&&e.meta.newName!==void 0){const i=n?e.meta.oldName:e.meta.newName;r.name=i}}}class xa{constructor(e){q(this,"context");q(this,"handlePointerDown",e=>{const{currentToolInstance:n,layerManager:r,penColor:i,penSize:a,displayCanvasElement:s}=this.context;if(!n||!r)return;const u=r.getActiveLayer();if(u&&e.target===s){const o=pt(u.canvas);let f;return e.pressure===0||e.pressure===.5&&e.pointerType!=="pen"?f=void 0:f=e.pressure,n.onPointerDown(e,u,i,a,f),o}});q(this,"handlePointerMove",e=>{const{currentToolInstance:n,layerManager:r,penColor:i,penSize:a,displayCanvasElement:s,requestRedraw:u}=this.context;if(!n||!r)return;const o=r.getActiveLayer();if(o&&e.target===s&&(e.buttons===1||e.pointerType==="touch")){let f;e.pressure===0||e.pressure===.5&&e.pointerType!=="pen"?f=void 0:f=e.pressure,n.onPointerMove(e,o,i,a,f),u()}});q(this,"handlePointerUp",(e,n)=>{const{currentToolInstance:r,layerManager:i,historyManager:a,displayCanvasElement:s,updateExternalStatePartial:u,requestRedraw:o}=this.context;if(!r||!i||!a)return;const f=i.getActiveLayer();if(f&&e.target===s&&n){r.onPointerUp(e,f);const v=pt(f.canvas);n!==v&&(a.addHistory({type:"stroke",layerId:f.id,imageDataBefore:n,imageDataAfter:v}),u(!1,!1,!0)),o()}});this.context=e}updateContext(e){this.context=e}}function pa(t,e,n){if(l(e)){const r=l(e).handlePointerDown(t);r!==void 0&&m(n,r,!0)}}function Ia(t,e){l(e)&&l(e).handlePointerMove(t)}var Ea=Q('<div class="canvas-container svelte-qi4oe4" style="width: 100%; height: 100%; touch-action: none;"><canvas style="position: absolute; top: 0; left: 0;"></canvas></div>');function ka(t,e){ke(e,!0);let n=F(e,"penColor",3,"#000000"),r=F(e,"penSize",3,5);F(e,"layers",19,()=>[]),F(e,"activeLayerId",3,null);let i=F(e,"currentToolType",3,"pen"),a=z(null),s=z(null),u=z(null),o=z(0),f=z(0),v=z(null),d=z(null),c=z(null),h=z(null),L=z(null),C=z(null),p=z(void 0),b=z(null),S=z(null);ce(()=>{var P;const y=l(v),I=l(h),k=l(L),A=l(C);if(I&&k&&A&&((P=y==null?void 0:y.getActiveLayer())!=null&&P.context)){const D=y.getActiveLayer().context;let R=l(c);R!=null&&R.deactivate&&D&&R.deactivate(D),i()==="pen"?m(c,I,!0):i()==="eraser"?m(c,k,!0):i()==="fill"&&m(c,A,!0),R=l(c),R!=null&&R.activate&&D&&R.activate(D),E()}});function x(y=!0){var A,P,D,R;const I=l(v);if(!I)return;(A=e.onlayersupdate)==null||A.call(e,I.getLayers()),(D=e.onactiveidupdate)==null||D.call(e,((P=I.getActiveLayer())==null?void 0:P.id)||null);const k=l(d);y&&k&&((R=e.onhistorychange)==null||R.call(e,{canUndo:k.canUndo(),canRedo:k.canRedo()}))}function w(y=!1,I=!1,k=!1){var P,D,R,K;const A=l(v);if(A&&(y&&((P=e.onlayersupdate)==null||P.call(e,A.getLayers())),I&&((R=e.onactiveidupdate)==null||R.call(e,((D=A.getActiveLayer())==null?void 0:D.id)||null)),k)){const re=l(d);re&&((K=e.onhistorychange)==null||K.call(e,{canUndo:re.canUndo(),canRedo:re.canRedo()}))}}function E(){requestAnimationFrame(_)}ce(()=>{if(l(b)){const y={layerManager:l(v),width:l(o),height:l(f),requestRedraw:E,updateExternalState:x,updateExternalStatePartial:w};l(b).updateContext(y)}}),ce(()=>{if(l(S)){const y={currentToolInstance:l(c),layerManager:l(v),historyManager:l(d),penColor:n(),penSize:r(),displayCanvasElement:l(a),imageDataBeforeStroke:l(p),requestRedraw:E,updateExternalState:x,updateExternalStatePartial:w};l(S).updateContext(y)}});async function g(){var D,R,K;await rr();const y=l(a);if(!y)return;const I=y.getContext("2d");if(!I)return;m(u,I,!0),m(v,new va(l(o),l(f)),!0),m(d,new ba,!0),m(h,new ya,!0),m(L,new wa,!0),m(C,new ma,!0);const k={layerManager:l(v),width:l(o),height:l(f),requestRedraw:E,updateExternalState:x,updateExternalStatePartial:w};m(b,new La(k),!0);const A={currentToolInstance:l(c),layerManager:l(v),historyManager:l(d),penColor:n(),penSize:r(),displayCanvasElement:l(a),imageDataBeforeStroke:l(p),requestRedraw:E,updateExternalState:x,updateExternalStatePartial:w};m(S,new xa(A),!0),i()==="pen"?m(c,l(h),!0):i()==="eraser"?m(c,l(L),!0):i()==="fill"?m(c,l(C),!0):m(c,l(h),!0);const P=(R=(D=l(v))==null?void 0:D.getActiveLayer())==null?void 0:R.context;P&&((K=l(c))!=null&&K.activate)&&l(c).activate(P),x(),E()}ce(()=>{const y=l(s);if(y){const I=()=>new Promise(P=>{const D=()=>{y.getBoundingClientRect();const R=y.clientWidth,K=y.clientHeight;R>0&&K>0?P({width:R,height:K}):requestAnimationFrame(D)};D()}),k=async()=>{const P=await I();m(o,P.width,!0),m(f,P.height,!0);const D=l(a);D&&(D.width=l(o),D.height=l(f)),await g()},A=new ResizeObserver(async P=>{for(let D of P){const R=D.contentRect.width,K=D.contentRect.height;if(R>0&&K>0&&(R!==l(o)||K!==l(f))){m(o,R,!0),m(f,K,!0);const re=l(a);re&&(re.width=l(o),re.height=l(f));const $e=l(v);$e&&($e.resizeLayers(l(o),l(f)),E())}}});return A.observe(y),k(),()=>{A.unobserve(y)}}});function _(){const y=l(u),I=l(v);if(!y||!I)return;y.clearRect(0,0,l(o),l(f));const k=I.getLayers().filter(A=>A.isVisible);for(const A of k)y.drawImage(A.canvas,0,0)}function M(y){l(S)&&(l(S).handlePointerUp(y,l(p)),m(p,void 0))}function W(y,I){l(b)&&l(b).applyHistoryAction(y,I)}async function $(){const y=l(v);if(!y||l(o)===0||l(f)===0||!e.imageWidth||!e.imageHeight)return console.error("Cannot export: LayerManager not ready, canvas dimensions are zero, or image dimensions not specified."),null;try{const I=y.getLayers().filter(D=>D.isVisible),k={width:l(o),height:l(f)},A={width:e.imageWidth,height:e.imageHeight},{canvas:P}=oa(I.map(D=>D.canvas),k,A);return await da(P,"skvetchy-drawing.png")}catch(I){return console.error("Failed to export PNG:",I),null}}function we(){const y=l(d);y&&(y.undo(W),x())}function Ze(){const y=l(d);y&&(y.redo(W),x())}function Je(){const y=l(v),I=l(d);if(!y||!I)return;const k=y.addLayer(void 0,l(o),l(f));I.addHistory({type:"addLayer",layerId:k.id}),w(!0,!0,!0),E()}function Qe(){const y=l(v),I=l(d);if(!y||!I)return;const k=y.getActiveLayer();if(k){const A=pt(k.canvas);dr(k.canvas,k.context);const P=pt(k.canvas);I.addHistory({type:"clearLayer",layerId:k.id,imageDataBefore:A,imageDataAfter:P}),w(!1,!1,!0),E()}}function he(y){const I=l(v);if(!I)return;const k=I.getActiveLayer();I.setActiveLayer(y);const A=I.getActiveLayer(),P=l(c);P!=null&&P.deactivate&&(k!=null&&k.context)&&P.deactivate(k.context),P!=null&&P.activate&&(A!=null&&A.context)&&P.activate(A.context),w(!1,!0,!1)}function Ne(y){const I=l(v),k=l(d);if(!I||!k)return;const A=I.findLayerById(y),P=I.findLayerIndexById(y);if(A){const D=ua(A.canvas),R={...A,canvas:D.canvas,context:D.context};k.addHistory({type:"deleteLayer",layerId:y,deletedLayerData:R,deletedLayerIndex:P})}I.deleteLayer(y),w(!1,!1,!0),E()}function Oe(y){const I=l(v),k=l(d);if(!I||!k)return;const A=I.findLayerById(y);if(A){const P=A.isVisible;I.toggleLayerVisibility(y),k.addHistory({type:"toggleLayerVisibility",layerId:y,visibilityBefore:P}),w(!1,!1,!0),E()}}function me(y){const I=l(v),k=l(d);if(!I||!k||!I.findLayerById(y.layerId))return;const P=I.reorderLayer(y.layerId,y.newIndex);P&&(k.addHistory({type:"reorderLayer",layerId:y.layerId,meta:{oldVisualIndex:P.oldVisualIndex,newVisualIndex:P.newVisualIndex,targetLayerId:y.layerId}}),w(!0,!1,!0),E())}function Ve(y,I){const k=l(v),A=l(d);if(!k||!A)return;const P=k.renameLayer(y,I);P&&(A.addHistory({type:"renameLayer",layerId:y,meta:{oldName:P.oldName,newName:I}}),w(!1,!1,!0))}function j(){return $()}var H=Ea();H.__pointerdown=[pa,S,p],H.__pointermove=[Ia,S],H.__pointerup=M;var be=B(H);return De(be,y=>m(a,y),()=>l(a)),De(H,y=>m(s,y),()=>l(s)),Pe("pointerleave",H,M),X(t,H),Ce({undo:we,redo:Ze,addLayer:Je,clearActiveLayer:Qe,setActiveLayer:he,deleteLayer:Ne,toggleLayerVisibility:Oe,reorderLayer:me,renameLayer:Ve,exportToPNG:j})}Be(["pointerdown","pointermove","pointerup"]);var Ca=Q('<span class="icon svelte-7j0u04"><!></span>');function xe(t,e){ke(e,!0);let n=F(e,"size",3,24),r=F(e,"color",3,"currentColor");const i={brush:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M3 21v-4a4 4 0 1 1 4 4z"/><path d="M21 3A16 16 0 0 0 8.2 13.2M21 3a16 16 0 0 1-10.2 12.8"/><path d="M10.6 9a9 9 0 0 1 4.4 4.4"/></g></svg>',eraser:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none"><path fill="currentColor" d="m5.505 11.41l.53.53zM3 14.952h-.75zM9.048 21v.75zM11.41 5.505l-.53-.53zm1.831 12.34a.75.75 0 0 0 1.06-1.061zM7.216 9.697a.75.75 0 1 0-1.06 1.061zm10.749 2.362l-5.905 5.905l1.06 1.06l5.905-5.904zm-11.93-.12l5.905-5.905l-1.06-1.06l-5.905 5.904zm0 6.025c-.85-.85-1.433-1.436-1.812-1.933c-.367-.481-.473-.79-.473-1.08h-1.5c0 .749.312 1.375.78 1.99c.455.596 1.125 1.263 1.945 2.083zm-1.06-7.086c-.82.82-1.49 1.488-1.945 2.084c-.468.614-.78 1.24-.78 1.99h1.5c0-.29.106-.6.473-1.08c.38-.498.962-1.083 1.812-1.933zm7.085 7.086c-.85.85-1.435 1.433-1.933 1.813c-.48.366-.79.472-1.08.472v1.5c.75 0 1.376-.312 1.99-.78c.596-.455 1.264-1.125 2.084-1.945zm-7.085 1.06c.82.82 1.487 1.49 2.084 1.945c.614.468 1.24.78 1.989.78v-1.5c-.29 0-.599-.106-1.08-.473c-.497-.38-1.083-.962-1.933-1.812zm12.99-12.99c.85.85 1.433 1.436 1.813 1.933c.366.481.472.79.472 1.08h1.5c0-.749-.312-1.375-.78-1.99c-.455-.596-1.125-1.263-1.945-2.083zm1.06 7.086c.82-.82 1.49-1.488 1.945-2.084c-.468.614-.78-1.24-.78-1.99h-1.5c0 .29-.106-.6-.473-1.08c-.38.498-.962-1.083-1.812-1.933zm0-8.146c-.82-.82-1.487-1.49-2.084-1.945c-.614-.468-1.24-.78-1.989-.78v1.5c.29 0 .599.106 1.08.473c.497.38 1.083-.962 1.933 1.812zm-7.085 1.06c.85-.85 1.435-1.433 1.933-1.812c.48-.367.79-.473 1.08-.473v-1.5c-.75 0-1.376.312-1.99-.78c-.596-.455-1.264-1.125-2.084 1.945zm2.362 10.749L7.216 9.698l-1.06 1.061l7.085 7.085z"/><path stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M9 21h12"/></g></svg>',"eye-open":'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M12 9a3 3 0 0 0-3 3a3 3 0 0 0 3 3a3 3 0 0 0 3-3a3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5a5 5 0 0 1 5-5a5 5 0 0 1 5 5a5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"/></svg>',"eye-closed":'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M1.606 6.08a1 1 0 0 1 1.313.526L2 7l.92-.394v-.001l.003.009l.021.045l.094.194c.086.172.219.424.4.729a13.4 13.4 0 0 0 1.67 2.237a12 12 0 0 0 .59.592C7.18 11.8 9.251 13 12 13a8.7 8.7 0 0 0 3.22-.602c1.227-.483 2.254-1.21 3.096-1.998a13 13 0 0 0 2.733-3.725l.027-.058l.005-.011a1 1 0 0 1 1.838.788L22 7l.92.394l-.003.005l-.004.008l-.011.026l-.04.087a14 14 0 0 1-.741 1.348a15.4 15.4 0 0 1-1.711 2.256l.797.797a1 1 0 0 1-1.414 1.415l-.84-.84a12 12 0 0 1-1.897 1.256l.782 1.202a1 1 0 1 1-1.676 1.091l-.986-1.514c-.679.208-1.404.355-2.176.424V16.5a1 1 0 0 1-2 0v-1.544c-.775-.07-1.5-.217-2.177-.425l-.985 1.514a1 1 0 0 1-1.676-1.09l.782-1.203c-.7-.37-1.332-.8-1.897-1.257l-.84.84a1 1 0 0 1-1.414-1.414l.797-.797a15.4 15.4 0 0 1-1.87-2.519a14 14 0 0 1-.591-1.107l-.033-.072l-.01-.021l-.002-.007l-.001-.002v-.001C1.08 7.395 1.08 7.394 2 7l-.919.395a1 1 0 0 1 .525-1.314" clip-rule="evenodd"/></svg>',layers:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M4.025 14.85q-.4-.3-.387-.787t.412-.788q.275-.2.6-.2t.6.2L12 18.5l6.75-5.225q.275-.2.6-.2t.6.2q.4.3.413.787t-.388.788l-6.75 5.25q-.55.425-1.225.425t-1.225-.425zm6.75.2l-5.75-4.475Q4.25 9.975 4.25 9t.775-1.575l5.75-4.475q.55-.425 1.225-.425t1.225.425l5.75 4.475q.775.6.775 1.575t-.775 1.575l-5.75 4.475q-.55.425-1.225.425t-1.225-.425M12 13.45L17.75 9L12 4.55L6.25 9zM12 9"/></svg>',fullscreen:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" fill-rule="evenodd"><path d="m12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"/><path fill="currentColor" d="M18.5 5.5H16a1.5 1.5 0 0 1 0-3h3A2.5 2.5 0 0 1 21.5 5v3a1.5 1.5 0 0 1-3 0zM8 5.5H5.5V8a1.5 1.5 0 1 1-3 0V5A2.5 2.5 0 0 1 5 2.5h3a1.5 1.5 0 1 1 0 3m0 13H5.5V16a1.5 1.5 0 0 0-3 0v3A2.5 2.5 0 0 0 5 21.5h3a1.5 1.5 0 0 0 0-3m8 0h2.5V16a1.5 1.5 0 0 1 3 0v3a2.5 2.5 0 0 1-2.5 2.5h-3a1.5 1.5 0 0 1 0-3"/></g></svg>',download:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="m12 16l-5-5l1.4-1.45l2.6 2.6V4h2v8.15l2.6-2.6L17 11zm-6 4q-.825 0-1.412-.587T4 18v-3h2v3h12v-3h2v3q0 .825-.587 1.413T18 20z"/></svg>',trash:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M7 21q-.825 0-1.412-.587T5 19V6H4V4h5V3h6v1h5v2h-1v13q0 .825-.587 1.413T17 21zM17 6H7v13h10zM9 17h2V8H9zm4 0h2V8h-2zM7 6v13z"/></svg>',bucket:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M19 11.5s-2 2.17-2 3.5a2 2 0 0 0 2 2a2 2 0 0 0 2-2c0-1.33-2-3.5-2-3.5M5.21 10L10 5.21L14.79 10m1.77-1.06L7.62 0L6.21 1.41l2.38 2.38l-5.15 5.15c-.59.56-.59 1.53 0 2.12l5.5 5.5c.29.29.68.44 1.06.44s.77-.15 1.06-.44l5.5-5.5c.59-.59.59-1.56 0-2.12"/></svg>'},a=je(()=>i[e.name]||""),s=je(()=>l(a).replace(/width="24"/,`width="${n()}"`).replace(/height="24"/,`height="${n()}"`).replace(/fill="currentColor"/g,`fill="${r()}"`).replace(/stroke="currentColor"/g,`stroke="${r()}"`));var u=Ca(),o=B(u);Wi(o,()=>l(s)),_e(()=>Lt(u,`display: inline-block; width: ${n()??""}px; height: ${n()??""}px;`)),X(t,u),Ce()}function Sa(t,e){var n;(n=e.onaddLayer)==null||n.call(e)}function Pa(t,e){m(e,t.target.value,!0)}var Ta=(t,e,n,r)=>{var i;l(e)!==l(n).id&&((i=r.onselectLayer)==null||i.call(r,l(n).id))},Aa=(t,e,n,r)=>{var i;(t.key==="Enter"||t.key===" ")&&l(e)!==l(n).id&&((i=r.onselectLayer)==null||i.call(r,l(n).id))},za=(t,e,n)=>e(t,l(n).id),Ma=Q('<input type="text" class="rename-input svelte-1mg5fnv"/>'),Da=(t,e,n)=>{(t.key==="Enter"||t.key===" ")&&e(l(n))},Ra=Q('<span class="layer-name svelte-1mg5fnv" role="button" tabindex="0"> </span>'),Ba=(t,e,n)=>{var r;t.stopPropagation(),(r=e.ontoggleVisibility)==null||r.call(e,l(n).id)},Na=(t,e,n)=>{var r;t.stopPropagation(),(r=e.ondeleteLayer)==null||r.call(e,l(n).id)},Oa=Q('<li><div class="layer-content svelte-1mg5fnv" tabindex="0" role="button"><!> <div class="layer-controls svelte-1mg5fnv"><button class="svelte-1mg5fnv"><!></button> <button title="Delete Layer" class="svelte-1mg5fnv"><!></button></div></div></li>'),Va=Q('<div class="layer-panel svelte-1mg5fnv"><div class="layer-header svelte-1mg5fnv"><h3 class="svelte-1mg5fnv">Layers</h3> <button class="add-layer-btn svelte-1mg5fnv" title="Add Layer">+</button></div> <ul class="svelte-1mg5fnv"></ul></div>');function Fa(t,e){ke(e,!0);let n=F(e,"layers",19,()=>[]),r=F(e,"activeLayerId",3,null),i=z(null),a=z(""),s=z(null),u=z(null),o=z(null);function f(g,_){g.dataTransfer.effectAllowed="move",g.dataTransfer.setData("text/plain",_),m(u,_,!0)}function v(g,_){g.preventDefault(),g.dataTransfer.dropEffect="move",_!==l(u)&&m(o,_,!0)}function d(g){g.target.classList.contains("layer-item")&&g.target.dataset.layerId===l(o)&&m(o,null)}function c(g,_){var W;g.preventDefault();const M=g.dataTransfer.getData("text/plain");if(M&&M!==_){const $=n().findIndex(we=>we.id===_);$!==-1&&((W=e.onreorderLayer)==null||W.call(e,{layerId:M,newIndex:$}))}m(u,null),m(o,null)}function h(){m(u,null),m(o,null)}async function L(g){var _,M;m(i,g.id,!0),m(a,g.name,!0),await rr(),(_=l(s))==null||_.focus(),(M=l(s))==null||M.select()}function C(g){var _;if(l(i)===g&&l(a).trim()!==""){const M=n().find(W=>W.id===g);M&&M.name!==l(a).trim()&&((_=e.onrenameLayer)==null||_.call(e,{layerId:g,newName:l(a).trim()}))}m(i,null)}function p(g,_){g.key==="Enter"?C(_):g.key==="Escape"&&m(i,null)}const b=je(()=>[...n()].reverse());var S=Va(),x=B(S),w=U(B(x),2);w.__click=[Sa,e];var E=U(x,2);qi(E,21,()=>l(b),g=>g.id,(g,_)=>{var M=Oa();let W;var $=B(M);$.__click=[Ta,i,_,e],$.__keydown=[Aa,i,_,e];var we=B($);{var Ze=j=>{var H=Ma();H.__input=[Pa,a],H.__keydown=[za,p,_],De(H,be=>m(s,be),()=>l(s)),_e(()=>Jt(H,l(a))),Pe("blur",H,()=>C(l(_).id)),X(j,H)},Je=j=>{var H=Ra();H.__keydown=[Da,L,_];var be=B(H);_e(()=>Pt(be,l(_).name)),X(j,H)};Ue(we,j=>{l(i)===l(_).id?j(Ze):j(Je,!1)})}var Qe=U(we,2),he=B(Qe);he.__click=[Ba,e,_];var Ne=B(he);const Oe=je(()=>l(_).isVisible?"eye-open":"eye-closed");xe(Ne,{get name(){return l(Oe)},size:16});var me=U(he,2);me.__click=[Na,e,_];var Ve=B(me);xe(Ve,{name:"trash",size:16}),_e(j=>{W=qe(M,1,"layer-item svelte-1mg5fnv",null,W,j),Ae(M,"draggable",l(i)!==l(_).id),Ae(M,"data-layer-id",l(_).id),Ae($,"title",l(i)===l(_).id?"Press Enter to save, Esc to cancel":l(_).name+` (Z: ${l(_).zIndex})`),Ae(he,"title",l(_).isVisible?"Hide Layer":"Show Layer"),he.disabled=l(i)===l(_).id,me.disabled=n().length<=1||l(i)===l(_).id},[()=>({active:l(_).id===r(),"drop-target":l(_).id===l(o)&&l(_).id!==l(u),editing:l(_).id===l(i)})]),Pe("dragstart",M,j=>{l(i)!==l(_).id&&f(j,l(_).id)}),Pe("dragover",M,j=>v(j,l(_).id)),Pe("dragleave",M,d),Pe("drop",M,j=>c(j,l(_).id)),Pe("dragend",M,h),X(g,M)}),X(t,S),Ce()}Be(["click","keydown","input"]);function qa(t,e,n){e()||n.onclose()}function Ha(t,e){t.key==="Escape"&&e.onclose()}var Ua=Q('<h4 id="modal-title" class="modal-title svelte-268ler"> </h4>'),ja=Q('<div class="modal-overlay svelte-268ler" role="presentation"><div><!> <!> <div class="modal-actions svelte-268ler"><button class="modal-close-button svelte-268ler">Close</button></div></div></div>');function rn(t,e){ke(e,!0);let n=F(e,"show",3,!1),r=F(e,"preventOverlayClose",3,!1),i=F(e,"customClass",3,""),a=aa(e,["$$slots","$$events","$$legacy","show","title","onclose","children","ariaLabelledBy","preventOverlayClose","customClass"]),s=z(null);function u(d){d.stopPropagation()}la(()=>{n()&&l(s)&&l(s).focus()}),ce(()=>{n()&&l(s)&&l(s).focus()});var o=Bi(),f=fi(o);{var v=d=>{var c=ja();c.__click=[qa,r,e],c.__keydown=[Ha,e];var h=B(c);ta(h,()=>({class:`modal-content ${i()??""}`,onclick:u,role:"dialog","aria-modal":"true","aria-labelledby":e.ariaLabelledBy||(e.title?"modal-title":void 0),tabindex:"0",...a}),void 0,"svelte-268ler");var L=B(h);{var C=x=>{var w=Ua(),E=B(w);_e(()=>Pt(E,e.title)),X(x,w)};Ue(L,x=>{e.title&&x(C)})}var p=U(L,2);Yi(p,()=>e.children);var b=U(p,2),S=B(b);S.__click=function(...x){var w;(w=e.onclose)==null||w.apply(this,x)},De(h,x=>m(s,x),()=>l(s)),X(d,c)};Ue(f,d=>{n()&&d(v)})}X(t,o),Ce()}Be(["click","keydown"]);function Wa(t,e){const n=parseInt(t.target.value);e.onsetsize(n)}var Ya=Q('<div class="brush-controls svelte-19ui5l8"><input type="range" id="brushSize" min="1" max="100" class="svelte-19ui5l8"/> <span> </span></div>');function Xa(t,e){ke(e,!0);let n=F(e,"show",3,!1),r=F(e,"toolType",3,"pen");const i=je(()=>r()==="pen"?"Brush Size":r()==="eraser"?"Eraser Size":"Fill Bucket");rn(t,{get show(){return n()},get title(){return l(i)},get onclose(){return e.onclose},children:s=>{var u=Ya(),o=B(u);o.__input=[Wa,e];var f=U(o,2),v=B(f);_e(()=>{Jt(o,e.penSize),Pt(v,`${e.penSize??""}px`)}),X(s,u)},$$slots:{default:!0}}),Ce()}Be(["input"]);function Ga(t,e){const n=t.target.value;e.onsetcolor(n)}var Ka=Q('<div class="color-controls svelte-cjkzmf"><input type="color" id="penColor" class="svelte-cjkzmf"/> <span class="svelte-cjkzmf"> </span></div>');function Za(t,e){ke(e,!0);let n=F(e,"show",3,!1);rn(t,{get show(){return n()},title:"Pen Color",get onclose(){return e.onclose},children:i=>{var a=Ka(),s=B(a);s.__input=[Ga,e];var u=U(s,2),o=B(u);_e(()=>{Jt(s,e.penColor),Pt(o,e.penColor)}),X(i,a)},$$slots:{default:!0}}),Ce()}Be(["input"]);function Ja(t,e){e()}function Qa(t,e){e()}async function $a(t,e,n){var i;const r=await e();if(r){(i=n.onexport)==null||i.call(n,r);const a=URL.createObjectURL(r),s=document.createElement("a");s.href=a,s.download=r.name,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}else console.error("Failed to export image")}function el(t,e,n){var i;const r=t.target;m(e,r.value,!0),(i=n.oncolorchange)==null||i.call(n,l(e))}var tl=(t,e)=>m(e,!l(e)),nl=(t,e)=>e("pen"),rl=(t,e)=>e("eraser"),il=(t,e)=>e("fill"),al=Q('<button title="Download" class="svelte-nw2jxf"><!></button>'),ll=Q('<button title="Toggle Fullscreen" class="svelte-nw2jxf"><!></button>'),sl=Q('<main><div class="canvas-wrapper svelte-nw2jxf"><!></div> <div class="toolbar svelte-nw2jxf"><button title="Layers" class="svelte-nw2jxf"><!></button> <button title="Pen"><!></button> <button title="Eraser"><!></button> <button title="Fill Bucket"><!></button> <input type="color" class="color-picker-button svelte-nw2jxf"/> <button title="Undo" class="svelte-nw2jxf"><span style="display: inline-block; transform: rotate(180deg);">➦</span></button> <button title="Redo" class="svelte-nw2jxf">➦</button> <!> <!></div> <!> <!> <!></main>');function ol(t,e){ke(e,!0);let n=F(e,"width",3,"100%"),r=F(e,"height",3,"100%"),i=F(e,"backgroundColor",3,"#333"),a=F(e,"initialPenColor",3,"#000000"),s=F(e,"initialPenSize",3,5),u=F(e,"initialTool",3,"pen"),o=F(e,"enableFullscreen",3,!1),f=F(e,"enableDownload",3,!1),v=F(e,"className",3,""),d=z(le([])),c=z(null),h=z(!1),L=z(!1),C=z(!1),p=z(le(a())),b=z(le(u())),S=z(!1),x=z(!1),w=z(!1),E,g,_=z(le(s())),M=z(20);const W=je(()=>l(b)==="pen"?l(_):l(M));function $(T){var V;m(d,T,!0),(V=e.onlayerschange)==null||V.call(e,l(d))}function we(T){var V;m(c,T,!0),(V=e.onactivelayerchange)==null||V.call(e,l(c))}function Ze(T){m(S,T.canUndo,!0),m(x,T.canRedo,!0)}function Je(T){var V;l(b)==="pen"?m(_,T,!0):m(M,T,!0),(V=e.onsizechange)==null||V.call(e,T)}function Qe(){be()}function he(){o()&&(document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():E==null||E.requestFullscreen().catch(T=>{console.error(`Error attempting to enable full-screen mode: ${T.message} (${T.name})`)}))}function Ne(){var T;m(w,!!document.fullscreenElement),(T=e.onfullscreentoggle)==null||T.call(e,l(w))}function Oe(){g==null||g.undo()}function me(){g==null||g.redo()}async function Ve(){return await(g==null?void 0:g.exportToPNG())}function j(){return l(d)}function H(){return l(c)}function be(){return g==null?void 0:g.addLayer()}function y(){return g==null?void 0:g.clearActiveLayer()}function I(T){var V;if(l(b)===T&&(T==="pen"||T==="eraser")){m(L,!0);return}m(b,T,!0),(V=e.ontoolchange)==null||V.call(e,l(b))}ce(()=>{m(p,a())}),ce(()=>{l(b)==="pen"&&m(_,s())}),ce(()=>{m(b,u())}),ce(()=>{if(o())return document.addEventListener("fullscreenchange",Ne),()=>{document.removeEventListener("fullscreenchange",Ne)}});var k=sl(),A=B(k),P=B(A);De(ka(P,{get penColor(){return l(p)},get penSize(){return l(W)},get currentToolType(){return l(b)},get imageWidth(){return e.imageWidth},get imageHeight(){return e.imageHeight},onlayersupdate:$,onactiveidupdate:we,onhistorychange:Ze,get layers(){return l(d)},get activeLayerId(){return l(c)}}),T=>g=T,()=>g);var D=U(A,2),R=B(D);R.__click=[tl,h];var K=B(R);xe(K,{name:"layers",size:20});var re=U(R,2);re.__click=[nl,I];let $e;var wr=B(re);xe(wr,{name:"brush",size:20});var ot=U(re,2);ot.__click=[rl,I];let an;var mr=B(ot);xe(mr,{name:"eraser",size:20});var ut=U(ot,2);ut.__click=[il,I];let ln;var br=B(ut);xe(br,{name:"bucket",size:20});var ft=U(ut,2);ft.__input=[el,p,e];var Tt=U(ft,2);Tt.__click=[Ja,Oe];var At=U(Tt,2);At.__click=[Qa,me];var sn=U(At,2);{var Lr=T=>{var V=al();V.__click=[$a,Ve,e];var Se=B(V);xe(Se,{name:"download",size:20}),X(T,V)};Ue(sn,T=>{f()&&T(Lr)})}var xr=U(sn,2);{var pr=T=>{var V=ll();V.__click=he;var Se=B(V);xe(Se,{name:"fullscreen",size:20}),X(T,V)};Ue(xr,T=>{o()&&T(pr)})}var on=U(D,2);{var Ir=T=>{rn(T,{get show(){return l(h)},title:"Layers",onclose:()=>m(h,!1),customClass:"layer-modal-content",ariaLabelledBy:"layers-title",children:Se=>{Fa(Se,{get layers(){return l(d)},get activeLayerId(){return l(c)},onselectLayer:ue=>g==null?void 0:g.setActiveLayer(ue),ondeleteLayer:ue=>g==null?void 0:g.deleteLayer(ue),ontoggleVisibility:ue=>g==null?void 0:g.toggleLayerVisibility(ue),onreorderLayer:ue=>g==null?void 0:g.reorderLayer(ue),onrenameLayer:ue=>g==null?void 0:g.renameLayer(ue.layerId,ue.newName),onaddLayer:Qe})},$$slots:{default:!0}})};Ue(on,T=>{l(h)&&T(Ir)})}var un=U(on,2);Za(un,{get show(){return l(C)},get penColor(){return l(p)},onsetcolor:T=>{var V;m(p,T,!0),(V=e.oncolorchange)==null||V.call(e,l(p))},onclose:()=>m(C,!1)});var Er=U(un,2);return Xa(Er,{get show(){return l(L)},get penSize(){return l(W)},get toolType(){return l(b)},onsetsize:Je,onclose:()=>m(L,!1)}),De(k,T=>E=T,()=>E),_e((T,V,Se)=>{qe(k,1,`sketchy-drawing ${v()??""}`,"svelte-nw2jxf"),Lt(k,`width: ${(typeof n()=="number"?n()+"px":n())??""}; height: ${(typeof r()=="number"?r()+"px":r())??""}; background-color: ${i()??""};`),Lt(A,`--aspect-ratio: ${e.imageWidth/e.imageHeight};`),$e=qe(re,1,"svelte-nw2jxf",null,$e,T),an=qe(ot,1,"svelte-nw2jxf",null,an,V),ln=qe(ut,1,"svelte-nw2jxf",null,ln,Se),Ae(ft,"title",`Color: ${l(p)??""}`),Tt.disabled=!l(S),At.disabled=!l(x)},[()=>({active:l(b)==="pen"}),()=>({active:l(b)==="eraser"}),()=>({active:l(b)==="fill"})]),na(ft,()=>l(p),T=>m(p,T)),X(t,k),Ce({undo:Oe,redo:me,exportToPNG:Ve,getLayers:j,getActiveLayerId:H,addLayer:be,clearActiveLayer:y})}Be(["click","input"]);var ul=Q('<main class="svelte-g944tl"><!></main>');function fl(t){let e;function n(u){console.log("Layers changed:",u.detail)}function r(u){console.log("Image exported:",u.detail)}function i(u){console.log("Tool changed to:",u.detail)}var a=ul(),s=B(a);De(ol(s,{imageWidth:1920,imageHeight:1080,backgroundColor:"#333",initialPenColor:"#ff0000",initialPenSize:8,initialTool:"pen",enableFullscreen:!0,enableDownload:!0,$$events:{layersChange:n,export:r,toolChange:i}}),u=>e=u,()=>e),X(t,a)}Ni(fl,{target:document.getElementById("app")});
